import{r as f,j as t}from"./index-DGJgCM5J.js";import{Q as te,B as b}from"./ReactToastify-rmhSocrJ.js";import{A as ae,a as U}from"./axios-CRQt0RwQ.js";import{C as ie}from"./CCard-C3DUveEw.js";import{C as ne}from"./CCardHeader-CE0IdLD4.js";import{B as re,C as oe,G as l,T as K}from"./Grid-DOge2fQI.js";import{g as se,a as le,s as J,r as de,b as C,_ as y,d as R,o as ce,u as ue,e as pe,h as X,i as ge,F as H,I as q,S as Q,T as _}from"./TextField-CqNwGKeB.js";import{M as h}from"./MenuItem-CzCPtNHy.js";import"./DefaultLayout-SbVRlm3y.js";import"./icon-logo-BMteN3f4.js";function xe(e){return le("MuiButton",e)}const k=se("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),he=f.createContext({}),me=f.createContext(void 0),ve=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],Pe=e=>{const{color:a,disableElevation:o,fullWidth:m,size:j,variant:v,classes:r}=e,c={root:["root",v,`${v}${C(a)}`,`size${C(j)}`,`${v}Size${C(j)}`,`color${C(a)}`,o&&"disableElevation",m&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${C(j)}`],endIcon:["icon","endIcon",`iconSize${C(j)}`]},d=ge(c,xe,r);return y({},r,d)},Z=e=>y({},e.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},e.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},e.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),be=J(re,{shouldForwardProp:e=>de(e)||e==="classes",name:"MuiButton",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:o}=e;return[a.root,a[o.variant],a[`${o.variant}${C(o.color)}`],a[`size${C(o.size)}`],a[`${o.variant}Size${C(o.size)}`],o.color==="inherit"&&a.colorInherit,o.disableElevation&&a.disableElevation,o.fullWidth&&a.fullWidth]}})(({theme:e,ownerState:a})=>{var o,m;const j=e.palette.mode==="light"?e.palette.grey[300]:e.palette.grey[800],v=e.palette.mode==="light"?e.palette.grey.A100:e.palette.grey[700];return y({},e.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":y({textDecoration:"none",backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:R(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},a.variant==="text"&&a.color!=="inherit"&&{backgroundColor:e.vars?`rgba(${e.vars.palette[a.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:R(e.palette[a.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},a.variant==="outlined"&&a.color!=="inherit"&&{border:`1px solid ${(e.vars||e).palette[a.color].main}`,backgroundColor:e.vars?`rgba(${e.vars.palette[a.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:R(e.palette[a.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},a.variant==="contained"&&{backgroundColor:e.vars?e.vars.palette.Button.inheritContainedHoverBg:v,boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2],backgroundColor:(e.vars||e).palette.grey[300]}},a.variant==="contained"&&a.color!=="inherit"&&{backgroundColor:(e.vars||e).palette[a.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[a.color].main}}),"&:active":y({},a.variant==="contained"&&{boxShadow:(e.vars||e).shadows[8]}),[`&.${k.focusVisible}`]:y({},a.variant==="contained"&&{boxShadow:(e.vars||e).shadows[6]}),[`&.${k.disabled}`]:y({color:(e.vars||e).palette.action.disabled},a.variant==="outlined"&&{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},a.variant==="contained"&&{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground})},a.variant==="text"&&{padding:"6px 8px"},a.variant==="text"&&a.color!=="inherit"&&{color:(e.vars||e).palette[a.color].main},a.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},a.variant==="outlined"&&a.color!=="inherit"&&{color:(e.vars||e).palette[a.color].main,border:e.vars?`1px solid rgba(${e.vars.palette[a.color].mainChannel} / 0.5)`:`1px solid ${R(e.palette[a.color].main,.5)}`},a.variant==="contained"&&{color:e.vars?e.vars.palette.text.primary:(o=(m=e.palette).getContrastText)==null?void 0:o.call(m,e.palette.grey[300]),backgroundColor:e.vars?e.vars.palette.Button.inheritContainedBg:j,boxShadow:(e.vars||e).shadows[2]},a.variant==="contained"&&a.color!=="inherit"&&{color:(e.vars||e).palette[a.color].contrastText,backgroundColor:(e.vars||e).palette[a.color].main},a.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},a.size==="small"&&a.variant==="text"&&{padding:"4px 5px",fontSize:e.typography.pxToRem(13)},a.size==="large"&&a.variant==="text"&&{padding:"8px 11px",fontSize:e.typography.pxToRem(15)},a.size==="small"&&a.variant==="outlined"&&{padding:"3px 9px",fontSize:e.typography.pxToRem(13)},a.size==="large"&&a.variant==="outlined"&&{padding:"7px 21px",fontSize:e.typography.pxToRem(15)},a.size==="small"&&a.variant==="contained"&&{padding:"4px 10px",fontSize:e.typography.pxToRem(13)},a.size==="large"&&a.variant==="contained"&&{padding:"8px 22px",fontSize:e.typography.pxToRem(15)},a.fullWidth&&{width:"100%"})},({ownerState:e})=>e.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${k.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${k.disabled}`]:{boxShadow:"none"}}),fe=J("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,a)=>{const{ownerState:o}=e;return[a.startIcon,a[`iconSize${C(o.size)}`]]}})(({ownerState:e})=>y({display:"inherit",marginRight:8,marginLeft:-4},e.size==="small"&&{marginLeft:-2},Z(e))),_e=J("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,a)=>{const{ownerState:o}=e;return[a.endIcon,a[`iconSize${C(o.size)}`]]}})(({ownerState:e})=>y({display:"inherit",marginRight:-4,marginLeft:8},e.size==="small"&&{marginRight:-2},Z(e))),L=f.forwardRef(function(a,o){const m=f.useContext(he),j=f.useContext(me),v=ce(m,a),r=ue({props:v,name:"MuiButton"}),{children:c,color:d="primary",component:S="button",className:u,disabled:g=!1,disableElevation:T=!1,disableFocusRipple:A=!1,endIcon:B,focusVisibleClassName:D,fullWidth:F=!1,size:O="medium",startIcon:N,type:W,variant:G="text"}=r,Y=pe(r,ve),M=y({},r,{color:d,component:S,disabled:g,disableElevation:T,disableFocusRipple:A,fullWidth:F,size:O,type:W,variant:G}),i=Pe(M),n=N&&t.jsx(fe,{className:i.startIcon,ownerState:M,children:N}),s=B&&t.jsx(_e,{className:i.endIcon,ownerState:M,children:B}),x=j||"";return t.jsxs(be,y({ownerState:M,className:X(m.className,i.root,u,x),component:S,disabled:g,focusRipple:!A,focusVisibleClassName:X(i.focusVisible,D),ref:o,type:W},Y,{classes:i,children:[n,c,s]}))}),Ae=()=>{const[e,a]=f.useState("Patient ID"),[o,m]=f.useState(""),[j,v]=f.useState([]),[r,c]=f.useState(null),[d,S]=f.useState(!1),[u,g]=f.useState({});f.useEffect(()=>{console.log("Component mounted or updated.")},[]);const T=()=>{console.log("Resetting form."),c(null),m(""),v([]),S(!1),g({})},A=i=>{a(i.target.value),m(""),v([])},B=(i,n)=>{console.log("Search value changed:",n),m(n),D(n)},D=async i=>{console.log("Fetching suggestions with value:",i);try{const n=await U.post("http://172.16.16.10:8082/api/PatientMstr/PatientSearchMaster",{YearId:2425,BranchId:2,SrchItem:e,srchVal:i});n.data&&n.data.patientList?v(n.data.patientList):v([])}catch{b.error("Error fetching suggestions")}},F=i=>{switch(i){case"MR":return"Mr";case"MRS":return"Mrs";case"MS":return"Ms";case"MISS":return"Miss";default:return i}},O=async(i,n)=>{if(n)try{console.log("Selected Patient:",n);const s=await U.post("http://172.16.16.10:8082/api/PatientMstr/PatientDetailsMaster",{YearId:2425,BranchId:2,PatCode:n.Patient_Code});if(console.log("Response from fetchPatientDetails:",s),s.data&&s.data.patDetails){const{patDetails:x}=s.data,P=(z=>{const $={};return Object.keys(z).forEach(E=>{typeof z[E]=="string"?$[E]=z[E].trim().replace(/\s*,\s*/g,","):$[E]=z[E]}),$})(x);P.Patient_Title=F(P.Patient_Title),c(P),S(!1);let p;switch(e){case"Patient ID":p=n.Patient_Code;break;case"Name":p=n.Patient_Name;break;case"Email":p=n.Patient_Email;break;case"Phone":p=n.Patient_Phno;break;default:p=""}m(p)}else b.error("Patient details not found")}catch(s){console.error("Error fetching patient details:",s),b.error("Error fetching patient details")}},N=i=>{if(!i)return;const n=new Date,s=new Date(i);let x=n.getFullYear()-s.getFullYear(),I=n.getMonth()-s.getMonth(),P=n.getDate()-s.getDate();(I<0||I===0&&P<0)&&(x--,I+=12),P<0&&(P=new Date(n.getFullYear(),n.getMonth(),0).getDate()+P,I--),c(p=>({...p,Patient_Ageyy:x!==0?x.toString():p.Patient_Ageyy,Patient_Agemm:I!==0?I.toString():p.Patient_Agemm,Patient_Agedd:P!==0?P.toString():p.Patient_Agedd}))},W=()=>{const i={};return r.Patient_Name||(i.Patient_Name="Name is required",b.warn("Please fill the required fields")),r.Patient_Phno&&!/^\d{10}$/.test(r.Patient_Phno)&&(i.Patient_Phno="please enter a valid phone number",b.error("Please enter a valid phone number")),r.Patient_mobile&&!/^\d{10}$/.test(r.Patient_mobile)&&(i.Patient_mobile="Invalid mobile number",b.error("please enter a valid mobile  number")),r.Patient_Email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.Patient_Email)&&(i.Patient_Email="Invalid email address",b.error("please enter a valid email address")),r.Patient_Ageyy===0&&r.Patient_Agemm===0&&r.Patient_Agedd===0&&(i.Patient_Age="Age is required",b.warn("Please fill in the age fields")),r.Patient_Ismale||(i.Patient_Ismale="Gender is required",b.warn("Please select the gender")),g(i),Object.keys(i).length===0},G=i=>{const n=i.target.value;let s="";switch(n){case"Mr":s="Male";break;case"Mrs":case"Ms":case"Miss":s="Female";break;default:s=""}c(x=>({...x,Patient_Title:n,Patient_Ismale:s})),g(x=>({...x,Patient_Ismale:""}))},Y=async()=>{if(!W())return;const i={...r,Patient_Name:r.Patient_Name.trim(),Patient_Email:r.Patient_Email.trim(),Patient_Phno:r.Patient_Phno.trim(),Patient_mobile:r.Patient_mobile.trim()};try{const n=d?1:0,s=await U.post("http://172.16.16.10:8082/api/PatientSaveUpdate",{...i,Patient_CpyId:2,Patient_YrId:2425,EditFlag:n});s.data.status&&s.data.status.length>0&&s.data.status[0].status==="Success"?(b.success("Patient details saved successfully"),d?S(!1):T()):b.error("Failed to save/update patient details")}catch(n){console.error("Error saving/updating patient details:",n),b.error("Error saving/updating patient details")}},M=(i,n)=>{const{Patient_Name:s,Patient_Email:x,Patient_Phno:I,Patient_Code:P}=n,p=o.toLowerCase(),z=($,E)=>{if(!E)return $;const w=$.split(new RegExp(`(${p})`,"gi"));return t.jsx("span",{children:w.map((V,ee)=>V.toLowerCase()===p?t.jsx("span",{style:{fontWeight:"bold",backgroundColor:"#a6e88d"},children:V},ee):V)})};return t.jsx("li",{...i,children:t.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%"},children:[t.jsx("div",{children:z(s||"",e==="Name")}),t.jsx("div",{children:z(x||"",e==="Email")}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{children:z(I||"",e==="Phone")}),t.jsx("span",{children:z(P||"",e==="Patient ID")})]})]})},n.Patient_Code)};return t.jsx(t.Fragment,{children:t.jsxs(ie,{className:"mb-4",children:[t.jsx(ne,{children:t.jsx("strong",{style:{fontSize:"2rem",color:"#523885",fontWeight:"bold"},children:"PATIENT REGISTRATION"})}),t.jsxs("div",{style:{minHeight:"100vh",padding:"20px"},children:[t.jsxs(oe,{component:"main",maxWidth:"md",children:[t.jsxs(l,{container:!0,spacing:2,children:[t.jsx(l,{item:!0,xs:12,sm:4,children:t.jsxs(H,{fullWidth:!0,variant:"outlined",sx:{height:"40px",marginBottom:"25px"},children:[t.jsx(q,{sx:{fontSize:"1rem",top:"-2px"},children:"Search By"}),t.jsxs(Q,{value:e,onChange:A,label:"Search By",sx:{height:"40px"},children:[t.jsx(h,{value:"Patient ID",children:"Patient ID"}),t.jsx(h,{value:"Name",children:"Name"}),t.jsx(h,{value:"Email",children:"Email"}),t.jsx(h,{value:"Phone",children:"Phone"})]})]})}),t.jsx(l,{item:!0,xs:12,sm:8,children:t.jsx(ae,{freeSolo:!0,options:j,getOptionLabel:i=>`${i.Patient_Name||""}, ${i.Patient_Email||""}, ${i.Patient_Phno||""}, ${i.Patient_Code||""}`,onInputChange:B,onChange:O,onClose:T,renderOption:M,renderInput:i=>t.jsx(_,{...i,label:e,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{style:{fontSize:"14px"}},InputProps:{...i.InputProps,style:{marginBottom:"20px"}},sx:{"& .MuiAutocomplete-inputRoot":{paddingRight:"0px"}}}),inputValue:o})})]}),r&&t.jsxs(l,{container:!0,spacing:2,children:[t.jsx(l,{item:!0,xs:12,sm:3,children:t.jsx(_,{id:"patientid",label:"Patient ID",variant:"outlined",value:r.Patient_Code,onChange:i=>c({...r,Patient_Code:i.target.value}),size:"small",fullWidth:!0,InputLabelProps:{style:{fontSize:"14px"}},disabled:!d})}),t.jsx(l,{item:!0,xs:12,sm:2,children:t.jsxs(H,{fullWidth:!0,variant:"outlined",sx:{width:"100%",height:"100%"},children:[t.jsx(q,{sx:{fontSize:"0.9rem",color:"rgba(0, 0, 0, 0.6)",marginTop:"-3px"},children:"Prefix"}),t.jsxs(Q,{name:"prefix",label:"Prefix",value:r.Patient_Title,onChange:G,sx:{width:"100%",height:"75%"},disabled:!d,children:[t.jsx(h,{value:"",children:t.jsx("em",{children:"None"})}),t.jsx(h,{value:"Mr",children:"Mr"}),t.jsx(h,{value:"Mrs",children:"Mrs"}),t.jsx(h,{value:"Ms",children:"Ms"}),t.jsx(h,{value:"Miss",children:"Miss"})]})]})}),t.jsx(l,{item:!0,xs:12,sm:7,children:t.jsx(_,{id:"name",label:"Name",variant:"outlined",value:r.Patient_Name||"",onChange:i=>{c({...r,Patient_Name:i.target.value}),g(n=>({...n,Patient_Name:""}))},size:"small",fullWidth:!0,InputLabelProps:{style:{fontSize:"14px"}},disabled:!d,error:!!u.Patient_Name})}),t.jsx(l,{item:!0,xs:12,sm:1,children:t.jsx(K,{style:{color:"rgba(0, 0, 0, 0.6)",marginBottom:"10px",fontSize:"14px",width:"100%",marginTop:"8px"},children:"Age:"})}),t.jsxs(l,{item:!0,container:!0,xs:12,sm:7,spacing:1,children:[t.jsx(l,{item:!0,xs:3,children:t.jsx(_,{id:"dd",label:"Day",variant:"outlined",size:"small",fullWidth:!0,value:r.Patient_Agedd,onChange:i=>{c({...r,Patient_Agedd:i.target.value}),g(n=>({...n,Patient_Age:""}))},InputLabelProps:{style:{fontSize:"14px"}},disabled:!d,error:!!u.Patient_Age,helperText:u.Patient_Age})}),t.jsx(l,{item:!0,xs:3,children:t.jsx(_,{id:"mm",label:"Month",variant:"outlined",size:"small",fullWidth:!0,value:r.Patient_Agemm,onChange:i=>{c({...r,Patient_Agemm:i.target.value}),g(n=>({...n,Patient_Age:""}))},InputLabelProps:{style:{fontSize:"14px"}},disabled:!d,error:!!u.Patient_Age,helperText:u.Patient_Age})}),t.jsx(l,{item:!0,xs:3,children:t.jsx(_,{id:"yyyy",label:"Year",variant:"outlined",size:"small",value:r.Patient_Ageyy,onChange:i=>{c({...r,Patient_Ageyy:i.target.value}),g(n=>({...n,Patient_Age:""}))},fullWidth:!0,InputLabelProps:{style:{fontSize:"14px"}},disabled:!d,error:!!u.Patient_Age,helperText:u.Patient_Age})}),t.jsx(l,{item:!0,xs:12,sm:3,children:t.jsxs(H,{variant:"outlined",size:"small",fullWidth:!0,children:[t.jsx(q,{id:"genderLabel",children:"Gender"}),t.jsxs(Q,{labelId:"genderLabel",id:"gender",label:"Gender",value:r.Patient_Ismale,InputProps:{readOnly:!0},disabled:!d,error:!!u.Patient_Ismale,children:[t.jsx(h,{value:"",children:t.jsx("em",{children:"None"})}),t.jsx(h,{value:"Male",children:"Male"}),t.jsx(h,{value:"Female",children:"Female"}),t.jsx(h,{value:"Other",children:"Other"})]}),u.Patient_Ismale&&t.jsx(K,{variant:"caption",color:"error",children:u.Patient_Ismale})]})})]}),t.jsx(l,{item:!0,xs:12,sm:4,children:t.jsx(_,{id:"dob",label:"Date of Birth",type:"date",variant:"outlined",size:"small",fullWidth:!0,value:r.Patient_Dob?r.Patient_Dob.split("T")[0]:"",onChange:i=>{const n=i.target.value;c({...r,Patient_Dob:n}),N(n)},InputLabelProps:{shrink:!0,style:{fontSize:"14px"}},disabled:!d})}),t.jsx(l,{item:!0,xs:12,sm:4,children:t.jsx(_,{id:"phone1",label:"Phone1",variant:"outlined",size:"small",value:r.Patient_Phno,onChange:i=>{c({...r,Patient_Phno:i.target.value}),g(n=>({...n,Patient_Phno:""}))},fullWidth:!0,InputLabelProps:{style:{fontSize:"14px"}},disabled:!d,error:!!u.Patient_Phno,helperText:u.Patient_Phno})}),t.jsx(l,{item:!0,xs:12,sm:4,children:t.jsx(_,{id:"phone2",label:"Phone2",variant:"outlined",size:"small",value:r.Patient_mobile,onChange:i=>{c({...r,Patient_mobile:i.target.value}),g(n=>({...n,Patient_mobile:""}))},fullWidth:!0,InputLabelProps:{style:{fontSize:"14px"}},disabled:!d,error:!!u.Patient_mobile,helperText:u.Patient_mobile})}),t.jsx(l,{item:!0,xs:12,sm:4,children:t.jsx(_,{id:"email",label:"Email",variant:"outlined",size:"small",value:r.Patient_Email,onChange:i=>{c({...r,Patient_Email:i.target.value}),g(n=>({...n,Patient_Email:""}))},fullWidth:!0,InputLabelProps:{style:{fontSize:"14px"}},disabled:!d,error:!!u.Patient_Email,helperText:u.Patient_Email})}),t.jsx(l,{item:!0,xs:12,children:t.jsx(_,{id:"address",label:"Address",variant:"outlined",size:"small",value:r.Patient_Address,onChange:i=>c({...r,Patient_Address:i.target.value}),fullWidth:!0,InputLabelProps:{style:{fontSize:"14px"}},disabled:!d})})]}),t.jsx(l,{container:!0,spacing:2,justifyContent:"flex-end",children:t.jsx(l,{item:!0,children:d?t.jsxs(t.Fragment,{children:[t.jsx(L,{variant:"contained",onClick:()=>S(!1),sx:{marginTop:2,marginRight:1},children:"Cancel"}),t.jsx(L,{variant:"contained",color:"primary",onClick:Y,sx:{marginTop:2},children:"Save"}),t.jsx(L,{variant:"contained",color:"primary",onClick:T,sx:{marginTop:2,marginLeft:2},children:"NEW"})]}):t.jsx(L,{variant:"contained",color:"primary",onClick:()=>S(!0),sx:{marginTop:2},children:"Edit"})})})]}),t.jsx(te,{position:"top-center",autoClose:3e3,hideProgressBar:!0})]})]})})};export{Ae as default};
