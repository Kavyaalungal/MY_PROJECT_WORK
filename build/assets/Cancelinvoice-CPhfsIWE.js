import{r as B,j as e}from"./index-DqIQyVV6.js";import{a as F}from"./axios-B4uVmeYG.js";import{Q as X,B as n}from"./ReactToastify-BTJwatDt.js";import{C as _}from"./CCard-BprZsov5.js";import{C as Q}from"./CCardBody-BMZ5hZJe.js";import{B as T,G as t,T as g,M as o}from"./MenuItem-41PeAd4x.js";import{C as b}from"./CButton-BSZMSOW-.js";import{T as a,F as v,I as E,S as q}from"./TextField-DxSLESMV.js";import{F as H}from"./FormGroup-GAHROrA8.js";import{F as m,C as c}from"./FormControlLabel-BISLvnLU.js";import"./Bill-Dgp8HSlF.js";const me=()=>{const y={PatTitle:"",BillDate:"",PatName:"",PatAgedd:"",PatAgemm:"",PatAgeyy:"",PatGender:"",PatPhone:"",PatEmail:"",RefBy:"",OutDr:"",BranchName:"",PatOpNo:"",CollMode:"",collBy:"",SampleOn:"",ReportTime:"",ReportRequest:"",Reportreqpersonal:!1,ReportReqphn:!1,ReportReqcourier:!1,ReportReqemail:!1,ReportReqsms:!1,NetAmount:"",CancelDate:"",Reason:""},P={LabNo:"",YrId:2324,CmId:2},[l,h]=B.useState(y),[z,R]=B.useState(P),O=()=>{h(y),R(P)},k=s=>{const{id:d,value:i}=s.target;R(r=>({...r,[d]:i}))},C=s=>{const{id:d,value:i}=s.target;h(r=>({...r,[d]:i})),console.log("FormData after change:",{...l,[d]:i})},w=s=>{s.key==="Enter"&&G()},G=()=>{const{LabNo:s,YrId:d,CmId:i}=z;F.get("http://172.16.16.10:8082/api/Cancelinvget",{params:{LabNo:s,YrId:d,CmId:i}}).then(r=>{console.log(r);const p=r.data.exist_dlts[0];h(p),n.success("data fetched successfully")}).catch(r=>{console.error("Error fetching the data",r),n.error("error in fetching data")})},V=()=>{console.log("Form Data before save:",l);const{PatName:s,CancelDate:d,LabNo:i,Reason:r,cmpyid:p,yrid:Y,PatPhone:I,PatEmail:S,PatAgedd:D,PatAgemm:L,PatAgeyy:W}=l,x=d||new Date().toISOString().split("T")[0];if(console.log("Final CancelDate:",x),console.log("Data being sent :",{PatName:s,finalCancelDate:x,LabNo:i,Reason:r}),!s||!i||!r||!x){console.error("Validation failed: Missing required fields"),n.error("Please fill in all required fields.");return}if(!r||r.trim()===""){console.error("Validation failed: Reason field is empty"),n.error("Please provide a reason.");return}if(S&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(S)){console.error("Validation failed: Invalid email format"),n.error("Please provide a valid email address.");return}if(I&&!/^[0-9]{10,15}$/.test(I)){console.error("Validation failed: Invalid phone number"),n.error("Please provide a valid phone number.");return}if(D&&L&&W&&((u,$,K)=>{const f=new Date,j=new Date(`${K}-${$}-${u}`),A=f.getFullYear()-j.getFullYear(),M=f.getMonth()-j.getMonth();return(M<0||M===0&&f.getDate()<j.getDate())&&A--,A})(D,L-1,W)>100){console.error("Validation failed: Age is greater than 100"),n.error("Age cannot be greater than 100.");return}const N={cmpyid:p,yrid:Y,PatName:s,CancelDate:x,LabNo:i,Reason:r||null};console.log("Data being sent to the backend:",N),F.post("http://172.16.16.10:8082/api/cancelpatdetails/dltscancel",N).then(u=>{console.log("Data saved successfully",u.data),n.success("Data saved successfully!")}).catch(u=>{console.error("Error saving the data",u),n.error("Error saving the data.")})};return e.jsx(e.Fragment,{children:e.jsx(_,{className:"mb-4",children:e.jsxs(Q,{children:[e.jsx(T,{sx:{padding:2},children:e.jsxs(t,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(t,{item:!0,xs:12,md:8,children:e.jsx(g,{variant:"h6",sx:{margin:0,fontSize:"24px",fontWeight:"bold",color:" #599eb4 "},children:"CANCEL INVOICE"})}),e.jsx(t,{item:!0,xs:12,md:4,children:e.jsxs(T,{sx:{display:"flex",justifyContent:{xs:"center",md:"flex-end"},gap:"16px"},children:[e.jsx(b,{color:"primary",style:{width:"100%",maxWidth:{xs:"100%",sm:"auto"}},onClick:V,children:"SAVE"}),e.jsx(b,{color:"primary",style:{width:"100%",maxWidth:{xs:"100%",sm:"auto"}},children:"EXIT"}),e.jsx(b,{color:"primary",style:{width:"100%",maxWidth:{xs:"100%",sm:"auto"}},onClick:O,children:"NEW"})]})})]})}),e.jsx("hr",{}),e.jsxs(t,{container:!0,spacing:2,children:[e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(a,{id:"LabNo",label:"Lab No",variant:"outlined",size:"small",fullWidth:!0,value:z.LabNo,onChange:k,onKeyPress:w,InputLabelProps:{style:{fontSize:"14px"}}})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(a,{id:"invDateTime",label:"Date",variant:"outlined",size:"small",fullWidth:!0,value:l.BillDate,type:"datetime-local",InputLabelProps:{shrink:!0}})}),e.jsx(t,{item:!0,xs:12,sm:2,children:e.jsxs(v,{fullWidth:!0,variant:"outlined",sx:{width:"100%",height:"100%"},children:[e.jsx(E,{sx:{fontSize:"1rem",color:"rgba(0, 0, 0, 0.6)",marginTop:"-2px"},children:"Prefix"}),e.jsxs(q,{name:"prefix",label:"Prefix",value:l.PatTitle,sx:{width:"100%",height:"75%"},children:[e.jsx(o,{value:"",children:e.jsx("em",{children:"None"})}),e.jsx(o,{value:"Mr",children:"Mr"}),e.jsx(o,{value:"Mrs",children:"Mrs"}),e.jsx(o,{value:"Ms",children:"Ms"}),e.jsx(o,{value:"Miss",children:"Miss"})]})]})}),e.jsx(t,{item:!0,xs:12,sm:10,children:e.jsx(a,{id:"name",label:"Name",variant:"outlined",size:"small",value:l.PatName,onChange:C,fullWidth:!0,InputLabelProps:{style:{fontSize:"16px"}}})}),e.jsx(t,{item:!0,xs:12,sm:1,children:e.jsx(g,{variant:"body1",gutterBottom:!0,sx:{fontWeight:"bold",color:"rgba(0, 0, 0, 0.7)",fontSize:"16px",marginTop:"8px",textAlign:"left"},children:"Age"})}),e.jsxs(t,{item:!0,container:!0,xs:12,sm:7,spacing:1,children:[e.jsx(t,{item:!0,xs:3,children:e.jsx(a,{id:"dd",label:"Day",variant:"outlined",value:l.PatAgedd,size:"small",fullWidth:!0,InputLabelProps:{style:{fontSize:"16px"}}})}),e.jsx(t,{item:!0,xs:3,children:e.jsx(a,{id:"mm",label:"Month",variant:"outlined",value:l.PatAgemm,size:"small",fullWidth:!0,InputLabelProps:{style:{fontSize:"16px"}}})}),e.jsx(t,{item:!0,xs:3,children:e.jsx(a,{id:"yyyy",label:"Year",variant:"outlined",value:l.PatAgeyy,size:"small",fullWidth:!0,InputLabelProps:{style:{fontSize:"16px"}}})}),e.jsx(t,{item:!0,xs:12,sm:3,children:e.jsxs(v,{variant:"outlined",size:"small",fullWidth:!0,children:[e.jsx(E,{id:"genderLabel",sx:{fontSize:"1rem",color:"rgba(0, 0, 0, 0.6)",marginTop:"-1px"},children:"Gender"}),e.jsxs(q,{labelId:"genderLabel",id:"gender",label:"Gender",value:l.PatGender,children:[e.jsx(o,{value:"",children:e.jsx("em",{children:"None"})}),e.jsx(o,{value:"M",children:"Male"}),e.jsx(o,{value:"F",children:"Female"}),e.jsx(o,{value:"O",children:"Other"})]})]})})]}),e.jsx(t,{item:!0,xs:12,sm:4,children:e.jsx(a,{id:"phone1",label:"Phone1",variant:"outlined",size:"small",value:l.PatPhone,fullWidth:!0,InputLabelProps:{style:{fontSize:"16px"}}})}),e.jsx(t,{item:!0,xs:12,sm:12,children:e.jsx(a,{id:"email",label:"Email",variant:"outlined",value:l.PatEmail,size:"small",fullWidth:!0,InputLabelProps:{style:{fontSize:"16px"}}})}),e.jsx(t,{item:!0,xs:12,sm:12,children:e.jsx(a,{id:"refby",label:"RefBy",value:l.RefBy,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{style:{fontSize:"16px"}}})}),e.jsx(t,{item:!0,xs:12,sm:12,children:e.jsx(a,{id:"outDr",label:"Out Dr",variant:"outlined",value:l.OutDr,size:"small",fullWidth:!0,InputLabelProps:{style:{fontSize:"16px"}}})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(a,{id:"branch",label:"Branch",variant:"outlined",value:l.BranchName,size:"small",fullWidth:!0,InputLabelProps:{style:{fontSize:"16px"}}})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(a,{id:"ipop",label:"IP/OP",variant:"outlined",value:l.PatOpNo,size:"small",fullWidth:!0,InputLabelProps:{style:{fontSize:"16px"}}})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(a,{id:"collmode",label:"Coll. Mode",variant:"outlined",value:l.CollMode,size:"small",fullWidth:!0,InputLabelProps:{style:{fontSize:"16px"}}})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(a,{id:"collby",label:"Coll. By",variant:"outlined",value:l.collBy,size:"small",fullWidth:!0,InputLabelProps:{style:{fontSize:"16px"}}})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(a,{id:"sampleOn",label:"Sample On",type:"datetime-local",variant:"outlined",value:l.SampleOn,size:"small",fullWidth:!0,InputLabelProps:{shrink:!0,style:{fontSize:"16px"}}})}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(a,{id:"reportTime",label:"Report Time",type:"datetime-local",variant:"outlined",value:l.ReportTime,size:"small",fullWidth:!0,InputLabelProps:{shrink:!0,style:{fontSize:"16px"}}})}),e.jsx(t,{item:!0,xs:12,children:e.jsxs(v,{component:"fieldset",children:[e.jsx(g,{variant:"body1",gutterBottom:!0,children:"Report Requested Through"}),e.jsxs(H,{row:!0,children:[e.jsx(m,{control:e.jsx(c,{checked:l.Reportreqpersonal,name:"personally"}),label:"Personally"}),e.jsx(m,{control:e.jsx(c,{checked:l.ReportReqcourier,name:"courier"}),label:"Courier"}),e.jsx(m,{control:e.jsx(c,{checked:l.ReportReqphn,name:"phone"}),label:"phone"}),e.jsx(m,{control:e.jsx(c,{checked:l.ReportReqemail,name:"email"}),label:"Email"}),e.jsx(m,{control:e.jsx(c,{checked:l.ReportReqsms,name:"sms"}),label:"SMS"})]})]})}),e.jsx(t,{item:!0,sm:6}),e.jsx(t,{item:!0,xs:12,sm:6,children:e.jsx(a,{id:"invamount",label:"Inv_Amount",variant:"outlined",size:"small",value:l.NetAmount,fullWidth:!0,InputLabelProps:{style:{fontSize:"16PX"}}})}),e.jsx(t,{item:!0,xs:12,sm:12,children:e.jsx(a,{id:"Reason",label:"Reason",variant:"outlined",required:!0,size:"small",value:l.Reason||"",onChange:C,fullWidth:!0,multiline:!0,rows:5,InputLabelProps:{style:{fontSize:"16px"}}})})]}),e.jsx(X,{position:"top-center",autoClose:3e3,hideProgressBar:!0})]})})})};export{me as default};
