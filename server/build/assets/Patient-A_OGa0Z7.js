import{r as P,j as t}from"./index-BXx8luc_.js";import{A as te,Q as ae,a as Y,B as b}from"./ReactToastify-C7wwpaJ_.js";import{C as ie}from"./CCard-D-Y3fOok.js";import{C as ne}from"./CCardHeader-CuBEVR94.js";import{B as oe,C as re,G as l,M as h,T as J}from"./MenuItem-BOJOPpjJ.js";import{a as se,g as le,s as q,z as de,e as C,_ as y,f as W,G as ce,u as ue,b as pe,c as K,d as xe,F as U,I as V,S as H,T as f}from"./TextField-DuK3Q-WV.js";import"./DefaultLayout-BGGq_p-o.js";import"./icon-logo-BhSL7PO9.js";function ge(e){return le("MuiButton",e)}const k=se("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),he=P.createContext({}),me=P.createContext(void 0),ve=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],Pe=e=>{const{color:a,disableElevation:r,fullWidth:m,size:_,variant:v,classes:o}=e,c={root:["root",v,`${v}${C(a)}`,`size${C(_)}`,`${v}Size${C(_)}`,`color${C(a)}`,r&&"disableElevation",m&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${C(_)}`],endIcon:["icon","endIcon",`iconSize${C(_)}`]},d=xe(c,ge,o);return y({},o,d)},X=e=>y({},e.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},e.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},e.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),be=q(oe,{shouldForwardProp:e=>de(e)||e==="classes",name:"MuiButton",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:r}=e;return[a.root,a[r.variant],a[`${r.variant}${C(r.color)}`],a[`size${C(r.size)}`],a[`${r.variant}Size${C(r.size)}`],r.color==="inherit"&&a.colorInherit,r.disableElevation&&a.disableElevation,r.fullWidth&&a.fullWidth]}})(({theme:e,ownerState:a})=>{var r,m;const _=e.palette.mode==="light"?e.palette.grey[300]:e.palette.grey[800],v=e.palette.mode==="light"?e.palette.grey.A100:e.palette.grey[700];return y({},e.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":y({textDecoration:"none",backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:W(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},a.variant==="text"&&a.color!=="inherit"&&{backgroundColor:e.vars?`rgba(${e.vars.palette[a.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:W(e.palette[a.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},a.variant==="outlined"&&a.color!=="inherit"&&{border:`1px solid ${(e.vars||e).palette[a.color].main}`,backgroundColor:e.vars?`rgba(${e.vars.palette[a.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:W(e.palette[a.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},a.variant==="contained"&&{backgroundColor:e.vars?e.vars.palette.Button.inheritContainedHoverBg:v,boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2],backgroundColor:(e.vars||e).palette.grey[300]}},a.variant==="contained"&&a.color!=="inherit"&&{backgroundColor:(e.vars||e).palette[a.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[a.color].main}}),"&:active":y({},a.variant==="contained"&&{boxShadow:(e.vars||e).shadows[8]}),[`&.${k.focusVisible}`]:y({},a.variant==="contained"&&{boxShadow:(e.vars||e).shadows[6]}),[`&.${k.disabled}`]:y({color:(e.vars||e).palette.action.disabled},a.variant==="outlined"&&{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},a.variant==="contained"&&{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground})},a.variant==="text"&&{padding:"6px 8px"},a.variant==="text"&&a.color!=="inherit"&&{color:(e.vars||e).palette[a.color].main},a.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},a.variant==="outlined"&&a.color!=="inherit"&&{color:(e.vars||e).palette[a.color].main,border:e.vars?`1px solid rgba(${e.vars.palette[a.color].mainChannel} / 0.5)`:`1px solid ${W(e.palette[a.color].main,.5)}`},a.variant==="contained"&&{color:e.vars?e.vars.palette.text.primary:(r=(m=e.palette).getContrastText)==null?void 0:r.call(m,e.palette.grey[300]),backgroundColor:e.vars?e.vars.palette.Button.inheritContainedBg:_,boxShadow:(e.vars||e).shadows[2]},a.variant==="contained"&&a.color!=="inherit"&&{color:(e.vars||e).palette[a.color].contrastText,backgroundColor:(e.vars||e).palette[a.color].main},a.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},a.size==="small"&&a.variant==="text"&&{padding:"4px 5px",fontSize:e.typography.pxToRem(13)},a.size==="large"&&a.variant==="text"&&{padding:"8px 11px",fontSize:e.typography.pxToRem(15)},a.size==="small"&&a.variant==="outlined"&&{padding:"3px 9px",fontSize:e.typography.pxToRem(13)},a.size==="large"&&a.variant==="outlined"&&{padding:"7px 21px",fontSize:e.typography.pxToRem(15)},a.size==="small"&&a.variant==="contained"&&{padding:"4px 10px",fontSize:e.typography.pxToRem(13)},a.size==="large"&&a.variant==="contained"&&{padding:"8px 22px",fontSize:e.typography.pxToRem(15)},a.fullWidth&&{width:"100%"})},({ownerState:e})=>e.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${k.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${k.disabled}`]:{boxShadow:"none"}}),fe=q("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,a)=>{const{ownerState:r}=e;return[a.startIcon,a[`iconSize${C(r.size)}`]]}})(({ownerState:e})=>y({display:"inherit",marginRight:8,marginLeft:-4},e.size==="small"&&{marginLeft:-2},X(e))),Ce=q("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,a)=>{const{ownerState:r}=e;return[a.endIcon,a[`iconSize${C(r.size)}`]]}})(({ownerState:e})=>y({display:"inherit",marginRight:-4,marginLeft:8},e.size==="small"&&{marginRight:-2},X(e))),A=P.forwardRef(function(a,r){const m=P.useContext(he),_=P.useContext(me),v=ce(m,a),o=ue({props:v,name:"MuiButton"}),{children:c,color:d="primary",component:j="button",className:u,disabled:g=!1,disableElevation:E=!1,disableFocusRipple:M=!1,endIcon:$,focusVisibleClassName:D,fullWidth:R=!1,size:L="medium",startIcon:T,type:B,variant:F="text"}=o,O=pe(o,ve),S=y({},o,{color:d,component:j,disabled:g,disableElevation:E,disableFocusRipple:M,fullWidth:R,size:L,type:B,variant:F}),i=Pe(S),n=T&&t.jsx(fe,{className:i.startIcon,ownerState:S,children:T}),s=$&&t.jsx(Ce,{className:i.endIcon,ownerState:S,children:$}),p=_||"";return t.jsxs(be,y({ownerState:S,className:K(m.className,i.root,u,p),component:j,disabled:g,focusRipple:!M,focusVisibleClassName:K(i.focusVisible,D),ref:r,type:B},O,{classes:i,children:[n,c,s]}))}),$e=()=>{const[e,a]=P.useState("Patient ID"),[r,m]=P.useState(""),[_,v]=P.useState([]),[o,c]=P.useState(null),[d,j]=P.useState(!1),[u,g]=P.useState({});P.useEffect(()=>{console.log("Component mounted or updated.")},[]);const E=()=>{console.log("Resetting form."),c(null),m(""),v([]),j(!1),g({})},M=i=>{a(i.target.value),m(""),v([])},$=(i,n)=>{console.log("Search value changed:",n),m(n),D(n)},D=async i=>{console.log("Fetching suggestions with value:",i);try{const n=await Y.post("http://172.16.16.10:8082/api/PatientMstr/PatientSearchMaster",{YearId:2425,BranchId:2,SrchItem:e,srchVal:i});n.data&&n.data.patientList?v(n.data.patientList):v([])}catch{b.error("Error fetching suggestions")}},R=i=>{switch(i){case"MR":return"Mr";case"MRS":return"Mrs";case"MS":return"Ms";case"MISS":return"Miss";default:return i}},L=async(i,n)=>{if(n)try{console.log("Selected Patient:",n);const s=await Y.post("http://172.16.16.10:8082/api/PatientMstr/PatientDetailsMaster",{YearId:2425,BranchId:2,PatCode:n.Patient_Code});if(console.log("Response from fetchPatientDetails:",s),s.data&&s.data.patDetails){const p={...s.data.patDetails,Patient_Title:R(s.data.patDetails.Patient_Title)};p.originalName=s.data.patDetails.Patient_Name,console.log("Patient Details:",p),c(p),console.log("Updated Patient Details State:",p),j(!1);let x;switch(e){case"Patient ID":x=n.Patient_Code;break;case"Name":x=n.Patient_Name;break;case"Email":x=n.Patient_Email;break;case"Phone":x=n.Patient_Phno;break;default:x=""}m(x)}else b.error("Patient details not found")}catch(s){console.error("Error fetching patient details:",s),b.error("Error fetching patient details")}},T=i=>{if(!i)return;const n=new Date,s=new Date(i);let p=n.getFullYear()-s.getFullYear(),x=n.getMonth()-s.getMonth(),z=n.getDate()-s.getDate();(x<0||x===0&&z<0)&&(p--,x+=12),z<0&&(z=new Date(n.getFullYear(),n.getMonth(),0).getDate()+z,x--),c(I=>({...I,Patient_Ageyy:p!==0?p.toString():I.Patient_Ageyy,Patient_Agemm:x!==0?x.toString():I.Patient_Agemm,Patient_Agedd:z!==0?z.toString():I.Patient_Agedd}))},B=()=>{const i={};return o.Patient_Name||(i.Patient_Name="Name is required",b.warn("Please fill the required fields")),o.Patient_Phno&&!/^\d{10}$/.test(o.Patient_Phno)&&(i.Patient_Phno="please enter a valid phone number",b.error("Please enter a valid phone number")),o.Patient_mobile&&!/^\d{10}$/.test(o.Patient_mobile)&&(i.Patient_mobile="Invalid mobile number",b.error("please enter a valid mobile  number")),o.Patient_Email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.Patient_Email)&&(i.Patient_Email="Invalid email address",b.error("please enter a valid email address")),o.Patient_Ismale||(i.Patient_Ismale="Gender is required",b.warn("Please select the gender")),g(i),Object.keys(i).length===0},F=i=>{const n=i.target.value;let s="";switch(n){case"Mr":s="Male";break;case"Mrs":case"Ms":case"Miss":s="Female";break;default:s=""}c(p=>({...p,Patient_Title:n,Patient_Ismale:s})),g(p=>({...p,Patient_Ismale:""}))},O=async()=>{if(B())try{const i=d?1:0;console.log("Edit Flag:",i);const n=await Y.post("http://172.16.16.10:8082/api/PatientSaveUpdate",{...o,Patient_CpyId:2,Patient_YrId:2425,EditFlag:i});console.log("response recieved",n),n.data.status&&n.data.status.length>0&&n.data.status[0].status==="Success"?(b.success("Patient details saved successfully"),d?j(!1):E()):b.error("Failed to save/update patient details")}catch(i){console.error("Error saving/updating patient details:",i),b.error("Error saving/updating patient details")}},S=(i,n)=>{const{Patient_Name:s,Patient_Email:p,Patient_Phno:x,Patient_Code:z}=n,I=r.toLowerCase(),N=(Q,Z)=>{if(!Z)return Q;const w=Q.split(new RegExp(`(${I})`,"gi"));return t.jsx("span",{children:w.map((G,ee)=>G.toLowerCase()===I?t.jsx("span",{style:{fontWeight:"bold",backgroundColor:"#a6e88d"},children:G},ee):G)})};return t.jsx("li",{...i,children:t.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%"},children:[t.jsx("div",{children:N(s||"",e==="Name")}),t.jsx("div",{children:N(p||"",e==="Email")}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{children:N(x||"",e==="Phone")}),t.jsx("span",{children:N(z||"",e==="Patient ID")})]})]})},n.Patient_Code)};return t.jsx(t.Fragment,{children:t.jsxs(ie,{className:"mb-4",children:[t.jsx(ne,{children:t.jsx("strong",{style:{fontSize:"2rem",color:"#523885",fontWeight:"bold"},children:"PATIENT REGISTRATION"})}),t.jsxs("div",{style:{minHeight:"100vh",padding:"20px"},children:[t.jsxs(re,{component:"main",maxWidth:"md",children:[t.jsxs(l,{container:!0,spacing:2,children:[t.jsx(l,{item:!0,xs:12,sm:4,children:t.jsxs(U,{fullWidth:!0,variant:"outlined",sx:{height:"40px",marginBottom:"25px"},children:[t.jsx(V,{sx:{fontSize:"1rem",top:"-2px"},children:"Search By"}),t.jsxs(H,{value:e,onChange:M,label:"Search By",sx:{height:"40px"},children:[t.jsx(h,{value:"Patient ID",children:"Patient ID"}),t.jsx(h,{value:"Name",children:"Name"}),t.jsx(h,{value:"Email",children:"Email"}),t.jsx(h,{value:"Phone",children:"Phone"})]})]})}),t.jsx(l,{item:!0,xs:12,sm:8,children:t.jsx(te,{freeSolo:!0,options:_,getOptionLabel:i=>`${i.Patient_Name||""}, ${i.Patient_Email||""}, ${i.Patient_Phno||""}, ${i.Patient_Code||""}`,onInputChange:$,onChange:L,onClose:E,renderOption:S,renderInput:i=>t.jsx(f,{...i,label:e,variant:"outlined",size:"small",fullWidth:!0,InputLabelProps:{style:{fontSize:"14px"}},InputProps:{...i.InputProps,style:{marginBottom:"20px"}},sx:{"& .MuiAutocomplete-inputRoot":{paddingRight:"0px"}}}),inputValue:r})})]}),o&&t.jsxs(l,{container:!0,spacing:2,children:[t.jsx(l,{item:!0,xs:12,sm:3,children:t.jsx(f,{id:"patientid",label:"Patient ID",variant:"outlined",value:o.Patient_Code,onChange:i=>c({...o,Patient_Code:i.target.value}),size:"small",fullWidth:!0,InputLabelProps:{style:{fontSize:"14px"}},disabled:!d})}),t.jsx(l,{item:!0,xs:12,sm:2,children:t.jsxs(U,{fullWidth:!0,variant:"outlined",sx:{width:"100%",height:"100%"},children:[t.jsx(V,{sx:{fontSize:"0.9rem",color:"rgba(0, 0, 0, 0.6)",marginTop:"-3px"},children:"Prefix"}),t.jsxs(H,{name:"prefix",label:"Prefix",value:o.Patient_Title,onChange:F,sx:{width:"100%",height:"75%"},disabled:!d,children:[t.jsx(h,{value:"",children:t.jsx("em",{children:"None"})}),t.jsx(h,{value:"Mr",children:"Mr"}),t.jsx(h,{value:"Mrs",children:"Mrs"}),t.jsx(h,{value:"Ms",children:"Ms"}),t.jsx(h,{value:"Miss",children:"Miss"})]})]})}),t.jsx(l,{item:!0,xs:12,sm:7,children:t.jsx(f,{id:"name",label:"Name",variant:"outlined",value:o.Patient_Name||"",onChange:i=>{c({...o,Patient_Name:i.target.value}),g(n=>({...n,Patient_Name:""}))},size:"small",fullWidth:!0,InputLabelProps:{style:{fontSize:"14px"}},disabled:!d,error:!!u.Patient_Name})}),t.jsx(l,{item:!0,xs:12,sm:1,children:t.jsx(J,{style:{color:"rgba(0, 0, 0, 0.6)",marginBottom:"10px",fontSize:"14px",width:"100%",marginTop:"8px"},children:"Age:"})}),t.jsxs(l,{item:!0,container:!0,xs:12,sm:7,spacing:1,children:[t.jsx(l,{item:!0,xs:3,children:t.jsx(f,{id:"dd",label:"Day",variant:"outlined",size:"small",fullWidth:!0,value:o.Patient_Agedd,onChange:i=>{c({...o,Patient_Agedd:i.target.value}),g(n=>({...n,Patient_Age:""}))},InputLabelProps:{style:{fontSize:"14px"}},disabled:!d,error:!!u.Patient_Age,helperText:u.Patient_Age})}),t.jsx(l,{item:!0,xs:3,children:t.jsx(f,{id:"mm",label:"Month",variant:"outlined",size:"small",fullWidth:!0,value:o.Patient_Agemm,onChange:i=>{c({...o,Patient_Agemm:i.target.value}),g(n=>({...n,Patient_Age:""}))},InputLabelProps:{style:{fontSize:"14px"}},disabled:!d,error:!!u.Patient_Age,helperText:u.Patient_Age})}),t.jsx(l,{item:!0,xs:3,children:t.jsx(f,{id:"yyyy",label:"Year",variant:"outlined",size:"small",value:o.Patient_Ageyy,onChange:i=>{c({...o,Patient_Ageyy:i.target.value}),g(n=>({...n,Patient_Age:""}))},fullWidth:!0,InputLabelProps:{style:{fontSize:"14px"}},disabled:!d,error:!!u.Patient_Age,helperText:u.Patient_Age})}),t.jsx(l,{item:!0,xs:12,sm:3,children:t.jsxs(U,{variant:"outlined",size:"small",fullWidth:!0,children:[t.jsx(V,{id:"genderLabel",children:"Gender"}),t.jsxs(H,{labelId:"genderLabel",id:"gender",label:"Gender",value:o.Patient_Ismale,InputProps:{readOnly:!0},disabled:!d,error:!!u.Patient_Ismale,children:[t.jsx(h,{value:"",children:t.jsx("em",{children:"None"})}),t.jsx(h,{value:"Male",children:"Male"}),t.jsx(h,{value:"Female",children:"Female"}),t.jsx(h,{value:"Other",children:"Other"})]}),u.Patient_Ismale&&t.jsx(J,{variant:"caption",color:"error",children:u.Patient_Ismale})]})})]}),t.jsx(l,{item:!0,xs:12,sm:4,children:t.jsx(f,{id:"dob",label:"Date of Birth",type:"date",variant:"outlined",size:"small",fullWidth:!0,value:o.Patient_Dob?o.Patient_Dob.split("T")[0]:"",onChange:i=>{const n=i.target.value;c({...o,Patient_Dob:n}),T(n)},InputLabelProps:{shrink:!0,style:{fontSize:"14px"}},disabled:!d})}),t.jsx(l,{item:!0,xs:12,sm:4,children:t.jsx(f,{id:"phone1",label:"Phone1",variant:"outlined",size:"small",value:o.Patient_Phno,onChange:i=>{c({...o,Patient_Phno:i.target.value}),g(n=>({...n,Patient_Phno:""}))},fullWidth:!0,InputLabelProps:{style:{fontSize:"14px"}},disabled:!d,error:!!u.Patient_Phno,helperText:u.Patient_Phno})}),t.jsx(l,{item:!0,xs:12,sm:4,children:t.jsx(f,{id:"phone2",label:"Phone2",variant:"outlined",size:"small",value:o.Patient_mobile,onChange:i=>{c({...o,Patient_mobile:i.target.value}),g(n=>({...n,Patient_mobile:""}))},fullWidth:!0,InputLabelProps:{style:{fontSize:"14px"}},disabled:!d,error:!!u.Patient_mobile,helperText:u.Patient_mobile})}),t.jsx(l,{item:!0,xs:12,sm:4,children:t.jsx(f,{id:"email",label:"Email",variant:"outlined",size:"small",value:o.Patient_Email,onChange:i=>{c({...o,Patient_Email:i.target.value}),g(n=>({...n,Patient_Email:""}))},fullWidth:!0,InputLabelProps:{style:{fontSize:"14px"}},disabled:!d,error:!!u.Patient_Email,helperText:u.Patient_Email})}),t.jsx(l,{item:!0,xs:12,children:t.jsx(f,{id:"address",label:"Address",variant:"outlined",size:"small",value:o.Patient_Address,onChange:i=>c({...o,Patient_Address:i.target.value}),fullWidth:!0,InputLabelProps:{style:{fontSize:"14px"}},disabled:!d})})]}),t.jsx(l,{container:!0,spacing:2,justifyContent:"flex-end",children:t.jsx(l,{item:!0,children:d?t.jsxs(t.Fragment,{children:[t.jsx(A,{variant:"contained",onClick:()=>j(!1),sx:{marginTop:2,marginRight:1},children:"Cancel"}),t.jsx(A,{variant:"contained",color:"primary",onClick:O,sx:{marginTop:2},children:"Save"}),t.jsx(A,{variant:"contained",color:"primary",onClick:E,sx:{marginTop:2,marginLeft:2},children:"NEW"})]}):t.jsx(A,{variant:"contained",color:"primary",onClick:()=>j(!0),sx:{marginTop:2},children:"Edit"})})})]}),t.jsx(ae,{position:"top-center",autoClose:3e3,hideProgressBar:!0})]})]})})};export{$e as default};
